<!-- © Copyright 2024, Pedro Almada
Licensed under the GPL-3.0-or-later

This file is part of the House buying calculator and is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with the house buying calculator software.
If not, see <https://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>House buying calculator</title>
</head>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">

<script src="js/update_currency.js"></script>
<script src="js/input_parameters.js"></script>
<script src="js/taxes.js"></script>
<script src="js/calculate.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="http://momentjs.com/downloads/moment-with-locales.js"></script>

<body>

<h1>House buying calculator</h1>

<form>
    <table>
    <tr>
        <th>Inputs</th>
        <th>Calculated values</th>
        <th>Chart</th>
    </tr>
    <tr>
        <td>
            <label for="currency">Currency (decorative only):</label>
            <input type="text" id="currency" name="currency" value="€" oninput="updateCurrency()">
            <br>
            <label for="house_price">House price:</label>
            <input type="number" id="house_price" name="house_price" step="5000" oninput="calculate()">
            <span class="currency-symbol">€</span>
            <br>
            <label for="savings">Savings:</label>
            <input type="number" id="savings" name="savings" step="1000" oninput="calculate()">
            <span class="currency-symbol">€</span>
            <br>
            <label for="monthly_savings">Monthly Savings:</label>
            <input type="number" id="monthly_savings" name="monthly_savings" step="100" oninput="calculate()">
            <span class="currency-symbol">€</span>
            <br>
            <label for="interest_rate">Interest rate:</label>
            <input type="number" id="interest_rate" name="interest_rate" step="0.1" oninput="calculate()">%
            <br>
            <label for="min_deposit">Minimum deposit required by bank:</label>
            <input type="number" id="min_deposit" name="min_deposit" oninput="calculate()">%
            <br>
            <label for="rent">Current rent:</label>
            <input type="number" id="rent" name="rent" step="100" oninput="calculate()">
            <span class="currency-symbol">€</span>
            <br>
            <label for="birth_date">Birthdate:</label>
            <input type="date" id="birth_date" name="birth_date" oninput="calculate()">
            <br>
            <label for="retirement_age">Retirement age:</label>
            <input type="number" id="retirement_age" name="retirement_age" oninput="calculate()">
            <br>
            <label for="taxes">Country (determines taxes to pay):</label>
            <select id="taxes" name="taxes" oninput="calculate()">
                <option value="spain">Spain</option>
                <option value="custom">Custom</option>
            </select>
            <br>
            <label for="custom_tax_amount">Custom tax amount: </label>
            <input type="number" id="custom_tax_amount" name="custom_tax_amount" step="1000" oninput="calculate()">
            <br>
        </td>
        <td class="calculated_values">
            <label for="date_retirement">Retirement date: </label><span id="date_retirement"></span>
            <br>
            <label for="months_retirement">Months until retirement: </label><span id="months_retirement"></span>
            <br>
            <label for="tax_amount">Tax for purchase: </label><span id="tax_amount"></span><span class="currency-symbol">€</span>
        </td>
        <td>
            <canvas id="totalCostChart" style="width: 100%; height: 100%;"></canvas>
        </td>
    </tr>
    <tr>
        <td id="scenario_1" class="scenario"></td>
        <td id="scenario_2" class="scenario"></td>
    </tr>
    </table>

    <div id="table">
        <table id="simulationsTable"></table>
    </div>

</form>

<div id="copyright_footer">
    © Copyright 2024, Pedro Almada, licensed under the GPL-3.0-or-later.
    <br>
    For license details, visit <a href="https://www.gnu.org/licenses/gpl-3.0.txt" target="_blank">this page</a>.
</div>

</body>

<script>
    const URL_PARAMS = new URLSearchParams(window.location.search);
    readParameter('house_price', URL_PARAMS, 100_000, 1000);
    readParameter('savings', URL_PARAMS, 1000, 0);
    readParameter('monthly_savings', URL_PARAMS, 100, 1);
    readParameter('interest_rate', URL_PARAMS, 3.5, 0.01, 100);
    readParameter('min_deposit', URL_PARAMS, 10, 0, 100);
    readParameter('rent', URL_PARAMS, 1000, 0);
    readParameter('birth_date', URL_PARAMS, '2001-09-11');
    readParameter('retirement_age', URL_PARAMS, 67, 18, 200);
    readSelection('taxes', URL_PARAMS);
    readParameter('custom_tax_amount', URL_PARAMS, 0, 0);

    Chart.defaults.font.family = 'Quicksand';
    let chart = new Chart('totalCostChart', {
        type: "line",
        data: {
            labels: [1],
            datasets: [{
                data: [1],
                borderColor: "red",
                fill: false
            }]
        },
        options: {
            plugins: {
                legend: {
                    display: false
                }
            }
        }
    });

    calculate();
</script>

</html>